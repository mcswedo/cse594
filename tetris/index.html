<!DOCTYPE html>
<head>
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
   <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
   <title>Tetris</title>
   <style>
      html, body, canvas {
         margin: 0;
         padding: 0
      }
      html, body { 
         width:100%; 
         height:100%; 
         overflow:hidden;
      }
	  canvas {
		 border-style: solid;
		 border-width: 5px;
	  }
   </style>
</head>

<body>
   <canvas id="canvas" width="250" height="450"></canvas>
   <script type="text/javascript" src="Cell.js"></script>
   <script type="text/javascript" src="Block.js"></script>
   <script type="text/javascript"> 

      var CELL_SIZE = 25;
      var INTERVAL = 150; // milliseconds
      var canvas = document.getElementById('canvas');
      var ctx = canvas.getContext('2d');
      var inactiveBlocks = [];
      var activeBlock = new Block();
      var cellPicture = new Image();

      cellPicture.src = 'cell.png';
      
      function clearGrid() {
         ctx.fillStyle = '#FFFFFF';
         ctx.fillRect(0, 0, 10 * CELL_SIZE, 18 * CELL_SIZE);
      }

      activeBlock.draw();

	  function doKeyDown(evt) {
		if(evt.keyCode === 37) { //Left Arrow
	      activeBlock.moveLeft();
		}
		if(evt.keyCode === 39) { //Right Arrow
			activeBlock.moveRight();
		}
		if(evt.keyCode === 32) { //Spacebar
			activeBlock.rotate();
		}
	  }
	  
      var interval = setInterval(function() {
         clearGrid();
         
         for (var i = 0; i < inactiveBlocks.length; ++i) {
            inactiveBlocks[i].draw();
         }
        
         if (activeBlock.canDrop()) {
            activeBlock.drop();
         } else {
            inactiveBlocks.push(activeBlock);
            activeBlock = new Block();
            if (activeBlock.canDrop() === false) {
               clearInterval(interval);
			   alert('Game Over!');
            }
         }
         activeBlock.draw();
     }, INTERVAL);

	 window.addEventListener('keydown', doKeyDown, true);
	 
   </script>

</body>
</html>
